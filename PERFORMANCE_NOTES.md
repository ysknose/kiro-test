# パフォーマンス改善メモ

## カテゴリ選択の遅延問題

### 実装した改善策

1. **専用 API エンドポイント**: `/api/equipment/categories` を作成
2. **キャッシュ戦略**:
   - フロントエンド: 30 分間キャッシュ（React Query）
   - バックエンド: HTTP キャッシュヘッダー（5 分間）
3. **UI 改善**: 読み込み中の状態表示

### 現在の制限

JSON Server は開発用のモックサーバーであり、大量のデータ（数千件以上）を扱う場合、以下の制限があります：

- すべてのデータをメモリに読み込む
- インデックスがない
- クエリ最適化がない

### 本番環境での推奨事項

大量のデータを扱う場合は、以下のいずれかに移行することを推奨：

1. **PostgreSQL + Prisma**

   ```sql
   -- カテゴリ一覧を高速取得
   SELECT DISTINCT category FROM equipment ORDER BY category;
   ```

2. **MongoDB**

   ```javascript
   // カテゴリ一覧を高速取得
   db.equipment.distinct('category').sort();
   ```

3. **Redis キャッシュ**
   - カテゴリ一覧を Redis にキャッシュ
   - 備品追加/更新時にキャッシュを無効化

### 現在の実装での最適化

現在の JSON Server 環境では、以下が最適な状態です：

- ✅ カテゴリ API を分離
- ✅ 長時間キャッシュ（30 分）
- ✅ HTTP キャッシュヘッダー
- ✅ ページング実装（1 ページ 20 件）

これ以上の改善には、データベースの変更が必要です。
